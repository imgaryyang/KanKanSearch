package com.kankanews.security;

import java.security.SecureRandom;

import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESKeySpec;

import org.apache.log4j.Logger;

public class DES {
	private static Logger logger = Logger.getLogger(DES.class);
	private final static String DES = "DES";

	public static void main(String[] params) throws Exception {
		params = new String[] { "ecdcd94e7786860314e294ad11a1109fb0a0be8c778d329eb95ce03e89a59270a05ca4b80e5f3d7e3ed94a9557444d1673b9cea6a16ba9c1ca93e2fb606abc2fc7ab2697eba9db243d078de60d1d25cc277ee26ac188a3157e1b6012d25ec5009efeb1ac1a3eba9de210c44d30190a3d4fb2e35381a422395294294e40095aed246409ba2588f3130ea0ec73223823a3f1389bc9283343bcb9facc6d7d127e35118e9154317412c359c215964b449c30b4da3eb88a815e3a45b8fddaa69bf2f8f4334ab17a06c047fc28b70cb17432f9142439c1ed5474b3b5426423323161706248dc27a0bcd04533381c8207fa70daf0835c8df113a0c89dc26f0e559d1ff4ce038d19d74c944a15f328ea0fdcae197767e85e19e02c852440b79c14f218283af71dafec4d5bdc892b7a95873dafc8f52bfbab365a4b13e1827ca5a74f80ce2aa3f19d9d700da35e32757257e366ae053993b32c139b42f559bb5901ca389c3b4fbdc6fd6c5994b66c9fc9a28a5e6b6cfccea7a47e5497ce2fe265036d1662cef131a9038eb96e351ca67984bf96fb9e8f1fdf9968bdbb485c5800bb360d51c6df02be3b0d1b8e2a3e3e258aa45765549c7c44955e36110d6cab0b4286e211516e60709b24ff646d13f006372f0fe095979715a9e6b740b60e3ac36ca1f06ba3e2fe312eb39e0ea42c23de003fc909bf61472c1cceb3b1d4de6c14efdac6c3362c8ffd58f40b477c1c789acad7c6f90af55aa77e2a6eb375c1399a3d8d27cc4f219d9b1da7a5b0d5c4accf543cf31f2acc8063c045fc9bce3cbea7c3f8983229ac2b931bede91f8f9a306dba266cf163f20e5d77fed7dda23143b67e0ed41878dd53ed5a2bff4e0b3cd61fdca7f793dbb6ded85c604b80daa34febfe025b43b25aad94fddf7d3c62c9ab1c69bc05033377e914e227bfa4289627208b2eacb2dac25eaa2db2232c8b9f80663821230a0911fd761c8f25e9f746ff18bb6b1e4e211fa373b6bd7fbff049f1486187c3d7935130dc3f6423010dfd478cb4b65cbd323ac8ec0e20621312c756f1e6d8a82707c897bf3200023c02c148ac23fed3685965e104a687806957b33137bceaacd58ed4a6ae4096ff9becf90a6888a7de1c4a21f377037871264f0704eb49d8f80a1479bef86a74b8410c0eae015911eea82a5d2b71b955de69cd5c638c9d06378f92aa25ef2966412a273ea453f8d01a01676bb23564b8ea42b2059a667da73a4b6e506570b7e6559207b8aff6c5270b1639d38b17e1f1bc083724f652f647f7ad9e72ea58509fb8346066313d3aab8a10d8d2abe91657085213996c745e4c524acfb56961c0030d57ae94b5e13832b5ed8130af0b68fbcf79723e90623b0fef05d0e25ad755d7cd733e77ad5b1d835bb9700c1e4b6e696b88dd130ec6295a4a82584dd6ea267e62e6cab17c7ed0414c7e7767e85e19e02c858262eefdce747bb3bcc21398360cff97b9e4215fdbf9cdf7b5402e7cbdae4ec67d543a7740a8c8684aae67801609d0e4debbee3f04a4d59dc120e515e06cfa51d7bbed4b05af401e18072217254bee57aae1e335391111683e962c99405b77b8da11fae56bb08145a6661d18111a15d3c6c88b0b6d6d3e016010ec5877a88b38703b83098686c93af0d4b373935990d307704c531b609ac0da148024e589c8915ee6f62607f468a0ca2a43a0cc97eccf4e4e9a73da8516adab7b81a7ee8f95ae273a87093a10622cdd79d86083d5aad26d83817bf69298f46d5c6b45e7c717de34c055ffc843d3527300f7d8f7847f1cfc06b137d06f80cbf54e44c8b44ad215142439c1ed5474b3b5426423323161706248dc27a0bcd04533381c8207fa70daf0835c8df113a0c89dc26f0e559d1ff4ce038d19d74c944a15f328ea0fdcae197767e85e19e02c852440b79c14f218283af71dafec4d5bdc892b7a95873dafc8f52bfbab365a4b13e1827ca5a74f80ce2aa3f19d9d700da35e32757257e366ae053993b32c139b42f559bb5901ca389c3b4fbdc6fd6c59949d7bfe6bf4c24e95dbe18bfa278175348f63e9477f7ad4716ed758fa9a6ec3ad87d1569e4749d7a9eccc41bb9fec13e13bb95dddee1f865b99373a15ce211f51ac16059f57ce53a0ce69241e4a19ccbec3849cacac1319c1cf56578531cacdb099e4f05b867e1f3fbe5eccbfb32298f47fea08176ed865bb3438e903a3fb9c448dd62fd3aaae321b7ac82238f71488ac3916ad3b8d9d03831d93996f24b15664bc26ac6933189e056b0012a1201560d6eb7cda3938c9a7fa81e541998377d3f0af6e80e76e41fe4fcb7f7415faa06f8c38bf00694b8891aed7acd5d54c936f40dfe3482083b3f2829e14526077033dcb5ee6f62607f468a0ca2a43a0cc97eccfb9a6190951e0ae39c10546f543cb9c71ed12d1d0ca30440cfca38566dadfc30959c215964b449c300dea9dc4044bdf6d45b8fddaa69bf2f8f4334ab17a06c047fc28b70cb17432f97590ced80c99b4aff32d11e30268a5de7627f26e62db8feffc302d7acd3f48c2e4b157f8ae8720b3c0f5c36c3e3a6d7e3537e6a09f9dca551b6bb484337ebb4cc08f58707201b2c378524091178d6b5c6b020e8be1ef28bf569c1e81cd8e009a092b3eaeed5c3002363b6850b873a0e845e7e5af2295399623b4287c69c7928213d51a739ba3899f4d9856b7ecfaa3d79fa3a14670f8211b74482d642e4b8a7e5121e8f52ef1802c6a4f81ec3173f50a8da8c0ad700c60de311cd7ecd11c1021d10b42624ad86f978ddaf3e06f85f50c421e165874ce756d2f081826734d541d388db6769766ef6a29be08cf6937da7173b9cea6a16ba9c1ca93e2fb606abc2fc7ab2697eba9db243d078de60d1d25cc277ee26ac188a3157e1b6012d25ec500b2ee75be94c43bd06027e926153f128a64cae3e8c53a2e29137ccf6fb8b85835e3c74f5639c37be794af06bf5ff456c67676337445c96875d5c4accf543cf31f2acc8063c045fc9bce3cbea7c3f8983229ac2b931bede91f8f9a306dba266cf163f20e5d77fed7dda23143b67e0ed418309bbef40cf7410a61f81331c0d79807dbb6ded85c604b80d4a3865d11ebe4beb25aad94fddf7d3c62c9ab1c69bc05033377e914e227bfa414a57bab59ada8b4dac25eaa2db2232c8b9f80663821230a0911fd761c8f25e9e30c5e846bf9e8c809fc30463c0316bdf049f1486187c3d7935130dc3f6423010dfd478cb4b65cbd323ac8ec0e20621312c756f1e6d8a82707c897bf3200023c02c148ac23fed3685965e104a687806957b33137bceaacd58ed4a6ae4096ff9becf90a6888a7de1c4a21f377037871264f0704eb49d8f80a1479bef86a74b8410c0eae015911eea82a5d2b71b955de69cd5c638c9d06378f92aa25ef2966412a273ea453f8d01a01676bb23564b8ea42b2059a667da73a4b6e506570b7e6559207b8aff6c5270b1639d38b17e1f1bc083724f652f647f7ad9e72ea58509fb8346066313d3aab8a10d8d2abe91657085213996c745e4c524acfb56961c0030d57ae94b5e13832b5ed9e83e896dbadb97721c2e78dd0bd81721716ea576b0603e32aec10feb1089da1fa412926569ece81053cbf2a63e3f3d7bb4e7b91ec9147bbcd3b89686440ef7f7b8618d79db46f28ec51fcc9d7402ff836fd33d105aa9a47d3ebb58b4a6a53898725e32cded84c22726c80c833fc5c5a877d1754d90fd042ecb6070e15ab01545e5509f49e7c7338a6c093520fa6157243cbae78bad80ff6b9f827329cccd0ec41314f7d6c622aff96fb91aac42a4ca73f144da1c1a6d086e3313efd58d9e752d462c3bd57304efe63f20e5d77fed7dda23143b67e0ed418a1d2abcd4b5107863f96f20713961c06dbb6ded85c604b80f458a369c7647bb5b25aad94fddf7d3c4c64fd475358dabbb8782e60491b86bc6c2fda6b37adc88106de12a96b3a3e434838be1cadc732feb8a0b4637d0a8025f4266cacafe741ac23a5d6d53689902017cb4b92c0f653e02ad578cbdb9215e23d88ab39dfd2abf8498eff033bef528e2394660770475088d4cda4dd73cca65dd7b68c91b6aad9a74ffbb6ae0606aa00b2059a667da73a4b6e506570b7e6559207b8aff6c5270b1639d38b17e1f1bc083724f652f647f7ad4f439933cede5cc40e4c232b7efbd1daa2ade7e034f72dec5e6bb1967114f3eae424a9cec13935762aa3f19d9d700da35e32757257e366ae053993b32c139b42f559bb5901ca389c3b4fbdc6fd6c599433e91e2aca403c6b6c18ede62d49b3a863dad89073d2a5e305b6e016ac7fb3b6de2fcaf205e1adc2f96617378d44099a99e4f05b867e1f3f4233f280b8b4997b3f2fc5cc9ced63b4d4d857489812932daa8a1fd4b584230694f3f4665c8982a5c1e47991da7425a0a54e7f695a5c1100e155e6d13722bb0160617e844640804937444f6eaa222519836dea869a23f358e825ad8f35dd60ca03632fa23392c30c047c07b9aec35519b419d803974d0b040cb48dfa5d8c753671857b11df6cc1d9b94b5e7e96efa7afe1c7fcd050e2c02d2c34b9719fca6d864750f25f8d85a955ebf908de55a0c75120ee12901851260df29165c1d6c4783a13ef68cfa94b5156e17f9b52ead79571546096ab4ee18d17d0f2d0bd4014887fa2066367384a8b7ba30c670fc1877e525949a9d4011ca2ec4f347336d61a1feb62379163e0f566da238760a2f464724a21a3445e4fd9864b1bb11930d39397ed09fc30463c0316bdf049f1486187c3d7935130dc3f6423010dfd478cb4b65cbd323ac8ec0e20621312c756f1e6d8a827ffacfd4096eb8ae002c148ac23fed3685965e104a687806957b33137bceaacd58ed4a6ae4096ff9becf90a6888a7de1c4a21f377037871264f0704eb49d8f80a1479bef86a74b8410c0eae015911eea82a5d2b71b955de69cd5c638c9d06378f92aa25ef2966412a273ea453f8d01a01676bb23564b8ea42b2059a667da73a4b6e506570b7e6559207b8aff6c5270b1639d38b17e1f1bc083724f652f647f7ad9e72ea58509fb8346066313d3aab8a10d8d2abe91657085213996c745e4c524acfb56961c0030d57ae94b5e13832b5ed65ad801a5cb0f6959658d1391c0476bd5be2e9e5a3aa15e112d1f028aaeb6cf2d4d857489812932daa8a1fd4b584230694f3f4665c8982a5c1e47991da7425a0a54e7f695a5c1100e155e6d13722bb01dbe552cfdc10bb06b92e2c71c965ec8f11e0ecee6b152a635b55e4c06312cc89c7a7f6c4da32fc8f30c29bcba8c42ed75941e0c841485c7630c9afb7d8f4c938bbbb4693233162a2546096ab4ee18d17d0f2d0bd4014887f89c6ebf9fee6ae3e64caead71e3cf403a7b0c11a429388c80ffd13793f4f3ad85e6b4094fda028ce2b5331e5685052b08ae854373d8714a30c87c7c5bbf8dbbb46aeae5e0932930c5d9eed0b8e2c8dfb8f07c787e915cc40b5426423323161706248dc27a0bcd04533381c8207fa70daf0835c8df113a0c89dc26f0e559d1ff4ce038d19d74c944a15f328ea0fdcae197767e85e19e02c852440b79c14f218283af71dafec4d5bdc892b7a95873dafc8f52bfbab365a4b13e1827ca5a74f80ce2aa3f19d9d700da35e32757257e366ae053993b32c139b42f559bb5901ca389c3b4fbdc6fd6c599433e91e2aca403c6b6c18ede62d49b3a8efcaba9294514aad76f90384391d8d6ac322d5fa550dc10e721ae44f902af38c0ec000a6f7e703da032086afed57509b06a042a8c6b1aa15cd5600a1689f39abc750c8348aaa6b897185acf9bb9ea28ceb8eabb66f43633f2448ffc503f5bf9f70e0238c8f7c4a73bc96e7d38a38f0964e4d7eb8cd1767cbb9f827329cccd0ecacb5284ef590d1f8f3ab19a171436fc2e8810ddd942eff06ee68331f6459e9b51398cc730af5a8bdb7a5fdf92d016b4945c2c9cb4b363f4857052f06322f88a06bcd5370904f1932965a67a99b2f145113666862f8e28e5a55c9469e627bf83db11d4510b5ab41e2bb7b01f581cb7f5cd02b61c4909269f748965357a109a8775b1aea447a88b0155220d1c49ae550fd6d83817bf69298f4a63b59db350b878e34c055ffc843d352cece569463b3b1e96a0d59a998c155d3e9de06dccd075c9188a9b6135cae8bcd7eb0cd1bb2a6dc66276a2686157360cd3384e614455316ac2c6086b70b132ce9a7e04075f2569638652dd15d478e7dafacd8f6f5480cbf9a443a2c4a45c13f4658ad794500a01ce8adf4434be9a427f74fbf78f958af83884b10f7189072ca19e446ea4af2a58a5f85a2a8785f1b0812da66382b45f17129dedfe457e6c7db1380ff0e9b87fee374783f2a4f71d28d41290598e08bab7b7c114b07dafb00a164efcaba9294514aad87fde0cd09c4340eb12b93de73e96fc578ad2f916024606b299cbe389acccd854240a12e67e01d6dc0e98427f4a7471aeb1cfb8744e1977763629147a2225e944a2ca6cb641f8aa0ac4b1da401a93f29eb9144c182bf9a2474f22ca167162d2d3721617e6dca8fd595ccc16bc2fa486bbdeb11a689986ac974a3bc2c6142ebc129be08cf6937da7173b9cea6a16ba9c1ca93e2fb606abc2fc7ab2697eba9db243d078de60d1d25cc277ee26ac188a3157e1b6012d25ec500b2ee75be94c43bd06027e926153f128a64cae3e8c53a2e29137ccf6fb8b85835e3c74f5639c37be790bb13babffea6cd5332b4251375031ea6661d18111a15d3c6c88b0b6d6d3e016010ec5877a88b38703b83098686c93af0d4b373935990d307704c531b609ac0da148024e589c8915ee6f62607f468a0ca2a43a0cc97eccf6535c15346adcc881f47a108042d9af34f0291c18660b153e2e43bb0eea30e0a59c215964b449c300dea9dc4044bdf6d45b8fddaa69bf2f8ee61ed9b60e5fe92c1d703b38d088763eb1e9658443b55e5a959f629f45766fd447b39d18c4046f9e3ebfe0fcc268ded4838be1cadc732feb8a0b4637d0a8025f4266cacafe741ac23a5d6d53689902017cb4b92c0f653e0d94e5ccf94f861333d88ab39dfd2abf8498eff033bef528e2394660770475088d4cda4dd73cca65dd7b68c91b6aad9a74ffbb6ae0606aa00b2059a667da73a4b6e506570b7e6559207b8aff6c5270b1639d38b17e1f1bc083724f652f647f7ad4f439933cede5cc49ae6a66873bfc42ef9a5a04d8a7cc7ebfeb7bfbd0dc7b4f513d51a739ba3899f4d9856b7ecfaa3d79fa3a14670f8211b74482d642e4b8a7ea802644cc73a5e6325cb3dbc55259b65ef7e17cd6b9286d98420741d63728a119a2a334bde8337fea79013031fe41e14", "shanghaifab", "decrypt" };
		if (params.length < 3) {
			logger.error("args is error");
			System.exit(0);
		}
		String data = params[0];
		String key = params[1];
		String type = params[2];
		// aaaa3827bb36db9867dc
		if (data == "" || key == "" || type == "") {
			logger.error("args is error");
			System.exit(0);
		}
		if ("encrypt".equals(type)) {
			System.out.println(bytesToHexString(encrypt(data.getBytes(),
					key.getBytes())));
		} else if ("decrypt".equals(type)) {
			System.out.print(new String(decrypt(hexStringToBytes(data),
					key.getBytes())));
		} else {
			System.out.print("type is no difined");
			System.exit(0);
		}
	}

	/**
	 * Description 根据键值进行加密
	 * 
	 * @param data
	 * @param key
	 *            加密键byte数组
	 * @return
	 * @throws Exception
	 */
	public static byte[] encrypt(byte[] data, byte[] key) throws Exception {
		// 生成一个可信任的随机数源
		SecureRandom sr = new SecureRandom();

		// 从原始密钥数据创建DESKeySpec对象
		DESKeySpec dks = new DESKeySpec(key);

		// 创建一个密钥工厂，然后用它把DESKeySpec转换成SecretKey对象
		SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(DES);
		SecretKey securekey = keyFactory.generateSecret(dks);

		// Cipher对象实际完成加密操作
		Cipher cipher = Cipher.getInstance(DES);

		// 用密钥初始化Cipher对象
		cipher.init(Cipher.ENCRYPT_MODE, securekey, sr);

		return cipher.doFinal(data);
	}

	/**
	 * Description 根据键值进行解密
	 * 
	 * @param data
	 * @param key
	 *            加密键byte数组
	 * @return
	 * @throws Exception
	 */
	public static byte[] decrypt(byte[] data, byte[] key) throws Exception {
		// 生成一个可信任的随机数源
		SecureRandom sr = new SecureRandom();

		// 从原始密钥数据创建DESKeySpec对象
		DESKeySpec dks = new DESKeySpec(key);

		// 创建一个密钥工厂，然后用它把DESKeySpec转换成SecretKey对象
		SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(DES);
		SecretKey securekey = keyFactory.generateSecret(dks);

		// Cipher对象实际完成解密操作
		Cipher cipher = Cipher.getInstance(DES);

		// 用密钥初始化Cipher对象
		cipher.init(Cipher.DECRYPT_MODE, securekey, sr);

		return cipher.doFinal(data);
	}

	public static String bytesToHexString(byte[] src) {
		StringBuilder stringBuilder = new StringBuilder("");
		if (src == null || src.length <= 0) {
			return null;
		}
		for (int i = 0; i < src.length; i++) {
			int v = src[i] & 0xFF;
			String hv = Integer.toHexString(v);
			if (hv.length() < 2) {
				stringBuilder.append(0);
			}
			stringBuilder.append(hv);
		}
		return stringBuilder.toString();
	}

	public static byte[] hexStringToBytes(String hexString) {
		if (hexString == null || hexString.equals("")) {
			return null;
		}
		hexString = hexString.toUpperCase();
		int length = hexString.length() / 2;
		char[] hexChars = hexString.toCharArray();
		byte[] d = new byte[length];
		for (int i = 0; i < length; i++) {
			int pos = i * 2;
			d[i] = (byte) (charToByte(hexChars[pos]) << 4 | charToByte(hexChars[pos + 1]));
		}
		return d;
	}

	private static byte charToByte(char c) {
		return (byte) "0123456789ABCDEF".indexOf(c);
	}
}
